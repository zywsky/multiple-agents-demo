# AEM to React Component Converter - å·¥ä½œæµæ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº LangGraph çš„å¤š Agent ç³»ç»Ÿï¼Œç”¨äºå°† AEM (Adobe Experience Manager) ç»„ä»¶è‡ªåŠ¨è½¬æ¢ä¸º React ç»„ä»¶ï¼ˆä½¿ç”¨ BDL ç»„ä»¶åº“ï¼‰ã€‚

## ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      WORKFLOW START                              â”‚
â”‚  è¾“å…¥: resourceType, AEM_REPO_PATH, BDL_LIBRARY_PATH             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  1. collect_files                    â”‚
        â”‚  - æ”¶é›†å½“å‰ç»„ä»¶æ–‡ä»¶                  â”‚
        â”‚  - æ„å»ºä¾èµ–æ ‘ï¼ˆé€’å½’ï¼‰                â”‚
        â”‚  - æ”¶é›†æ‰€æœ‰ä¾èµ–ç»„ä»¶æ–‡ä»¶              â”‚
        â”‚  è¾“å‡º: files[], dependency_tree{}    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  2. analyze_aem_files                â”‚
        â”‚  - åˆ†æå½“å‰ç»„ä»¶æ–‡ä»¶ï¼ˆHTL/Dialog/JSï¼‰â”‚
        â”‚  - é€’å½’åˆ†æä¾èµ–ç»„ä»¶æ–‡ä»¶              â”‚
        â”‚  - æå–å…³é”®ä¿¡æ¯                      â”‚
        â”‚  è¾“å‡º: file_analyses[],              â”‚
        â”‚        dependency_analyses{}         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  3. select_bdl_components             â”‚
        â”‚  - åˆ†æ AEM ç»„ä»¶åŠŸèƒ½                  â”‚
        â”‚  - åœ¨ BDL åº“ä¸­æœç´¢åŒ¹é…ç»„ä»¶            â”‚
        â”‚  - éªŒè¯ç»„ä»¶ç›¸å…³æ€§                     â”‚
        â”‚  - é‡æ–°æœç´¢ä¸åˆé€‚çš„ç»„ä»¶ï¼ˆå¯é€‰ï¼‰      â”‚
        â”‚  è¾“å‡º: selected_bdl_components[]      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  4. write_code                        â”‚
        â”‚  - ç”Ÿæˆ React ç»„ä»¶ä»£ç                 â”‚
        â”‚  - ä½¿ç”¨ AEM åˆ†æå’Œ BDL ç»„ä»¶ä¿¡æ¯       â”‚
        â”‚  - å¤„ç†ä¾èµ–ç»„ä»¶                       â”‚
        â”‚  - åŸºæœ¬ä»£ç éªŒè¯                       â”‚
        â”‚  è¾“å‡º: generated_code, code_file_path â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  5. review_code                       â”‚
        â”‚  - Security Review                   â”‚
        â”‚  - Build Review                      â”‚
        â”‚  - BDL Review                        â”‚
        â”‚  è¾“å‡º: review_results{},              â”‚
        â”‚        review_passed (bool)           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  should_continueâ”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                â”‚
        â–¼                                â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   END   â”‚                    â”‚ 6. correct_codeâ”‚
   â”‚ (é€šè¿‡)   â”‚                    â”‚ - ä¿®æ­£æ‰€æœ‰é—®é¢˜â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚ - æ›´æ–°ä»£ç     â”‚
                                  â”‚ è¾“å‡º:          â”‚
                                  â”‚ generated_code â”‚
                                  â”‚ iteration++    â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚ 5. review_codeâ”‚
                                  â”‚ (å†æ¬¡å®¡æŸ¥)    â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â””â”€â”€â”€â”
                                              â”‚
                                              â–¼
                                    (å¾ªç¯ç›´åˆ°é€šè¿‡æˆ–è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°)
```

## ğŸ“ è¯¦ç»†æ­¥éª¤è¯´æ˜

### æ­¥éª¤ 1: æ”¶é›†æ–‡ä»¶ (`collect_files`)

**ç›®çš„**: æ”¶é›†å½“å‰ç»„ä»¶å’Œæ‰€æœ‰ä¾èµ–ç»„ä»¶çš„æ–‡ä»¶

**å¤„ç†æµç¨‹**:
1. æ”¶é›†å½“å‰ç»„ä»¶ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
2. ä» HTL æ–‡ä»¶ä¸­æå– `data-sly-resource` å¼•ç”¨
3. é€’å½’æŸ¥æ‰¾æ‰€æœ‰ä¾èµ–ç»„ä»¶
4. æ”¶é›†æ‰€æœ‰ä¾èµ–ç»„ä»¶çš„æ–‡ä»¶
5. æ„å»ºä¾èµ–æ ‘ç»“æ„

**è¾“å…¥**:
- `component_path`: å½“å‰ç»„ä»¶è·¯å¾„
- `resource_type`: ç»„ä»¶ resourceType
- `aem_repo_path`: AEM repository æ ¹è·¯å¾„

**è¾“å‡º**:
- `files`: æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨ï¼ˆå½“å‰ç»„ä»¶ + ä¾èµ–ç»„ä»¶ï¼‰
- `dependency_tree`: ä¾èµ–æ ‘ç»“æ„

**å…³é”®ç‰¹æ€§**:
- âœ… é€’å½’ä¾èµ–è§£æ
- âœ… å¾ªç¯ä¾èµ–æ£€æµ‹
- âœ… æœ€å¤§æ·±åº¦é™åˆ¶ï¼ˆ5 å±‚ï¼‰

---

### æ­¥éª¤ 2: åˆ†æ AEM æ–‡ä»¶ (`analyze_aem_files`)

**ç›®çš„**: æ·±å…¥åˆ†ææ‰€æœ‰ AEM æ–‡ä»¶ï¼Œæå–å…³é”®ä¿¡æ¯

**å¤„ç†æµç¨‹**:
1. åˆ†ç¦»å½“å‰ç»„ä»¶æ–‡ä»¶å’Œä¾èµ–ç»„ä»¶æ–‡ä»¶
2. ä¼˜å…ˆåˆ†æå…³é”®æ–‡ä»¶ï¼ˆHTL > Dialog > JS > Configï¼‰
3. åˆ†æå½“å‰ç»„ä»¶çš„æ‰€æœ‰å…³é”®æ–‡ä»¶
4. é€’å½’åˆ†æä¾èµ–ç»„ä»¶çš„å…³é”®æ–‡ä»¶
5. æå– UI ç»“æ„ã€Props å®šä¹‰ã€äº¤äº’é€»è¾‘ç­‰

**è¾“å…¥**:
- `files`: æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨
- `dependency_tree`: ä¾èµ–æ ‘

**è¾“å‡º**:
- `file_analyses`: å½“å‰ç»„ä»¶çš„åˆ†æç»“æœ
- `dependency_analyses`: ä¾èµ–ç»„ä»¶çš„åˆ†æç»“æœï¼ˆæŒ‰ resourceType åˆ†ç»„ï¼‰

**åˆ†æå†…å®¹**:
- **HTL æ¨¡æ¿**: UI ç»“æ„ã€data-sly-* ä½¿ç”¨ã€æ¨¡å‹å¼•ç”¨ã€äº‹ä»¶å¤„ç†å™¨
- **Dialog XML**: å­—æ®µå®šä¹‰ã€ç±»å‹ã€å¿…å¡«é¡¹ã€é»˜è®¤å€¼
- **JavaScript**: äº‹ä»¶å¤„ç†ã€DOM æ“ä½œã€æ•°æ®è·å–
- **Config**: ç»„ä»¶å…ƒæ•°æ®ã€ç»„åˆå…³ç³»

**å…³é”®ç‰¹æ€§**:
- âœ… æ–‡ä»¶ä¼˜å…ˆçº§æ’åº
- âœ… ç»“æ„åŒ–è¾“å‡ºï¼ˆPydantic æ¨¡å‹ï¼‰
- âœ… ä¾èµ–ç»„ä»¶æ ‡è®°ï¼ˆ`component_resource_type`ï¼‰
- âœ… é™åˆ¶æ¯ä¸ªä¾èµ–ç»„ä»¶æœ€å¤šåˆ†æ 10 ä¸ªæ–‡ä»¶

---

### æ­¥éª¤ 3: é€‰æ‹© BDL ç»„ä»¶ (`select_bdl_components`)

**ç›®çš„**: æ ¹æ® AEM ç»„ä»¶åŠŸèƒ½ï¼Œåœ¨ BDL åº“ä¸­é€‰æ‹©åˆé€‚çš„ç»„ä»¶

**å¤„ç†æµç¨‹**:
1. æ„å»º AEM ç»„ä»¶æ‘˜è¦ï¼ˆåŠŸèƒ½ã€UI æ¨¡å¼ã€ç‰¹æ€§ï¼‰
2. åœ¨ BDL åº“ä¸­æœç´¢åŒ¹é…çš„ç»„ä»¶
3. éªŒè¯é€‰æ‹©çš„ç»„ä»¶ç›¸å…³æ€§
4. å¦‚æœç»„ä»¶ä¸åˆé€‚ï¼Œé‡æ–°æœç´¢æ›¿ä»£æ–¹æ¡ˆ
5. è¿”å›æœ€ç»ˆé€‰æ‹©çš„ç»„ä»¶åˆ—è¡¨

**è¾“å…¥**:
- `file_analyses`: AEM æ–‡ä»¶åˆ†æç»“æœ
- `bdl_library_path`: BDL åº“è·¯å¾„

**è¾“å‡º**:
- `selected_bdl_components`: é€‰å®šçš„ BDL ç»„ä»¶è·¯å¾„åˆ—è¡¨
- `aem_component_summary`: AEM ç»„ä»¶ç»¼åˆæ‘˜è¦

**é€‰æ‹©ç­–ç•¥**:
- åˆ†æ AEM ç»„ä»¶çš„ UI æ¨¡å¼ï¼ˆbutton, form, dialog, grid, etc.ï¼‰
- åŒ¹é… BDL ç»„ä»¶çš„åŠŸèƒ½
- è€ƒè™‘ç»„ä»¶ç»„åˆï¼ˆå¯èƒ½éœ€è¦å¤šä¸ª BDL ç»„ä»¶ï¼‰
- éªŒè¯ç›¸å…³æ€§ï¼ˆæœ€å°ç›¸å…³æ€§é˜ˆå€¼ï¼š0.4ï¼‰

**å…³é”®ç‰¹æ€§**:
- âœ… æ™ºèƒ½ç»„ä»¶åŒ¹é…
- âœ… ç›¸å…³æ€§éªŒè¯
- âœ… é‡æ–°æœç´¢æœºåˆ¶
- âœ… ç»“æ„åŒ–è¾“å‡º

---

### æ­¥éª¤ 4: ç¼–å†™ä»£ç  (`write_code`)

**ç›®çš„**: ç”Ÿæˆå®Œæ•´çš„ React ç»„ä»¶ä»£ç 

**å¤„ç†æµç¨‹**:
1. åˆ†ç±»æ–‡ä»¶åˆ†æç»“æœï¼ˆHTL, Dialog, JSï¼‰
2. æ„å»ºå…³é”®ä¿¡æ¯æ‘˜è¦
3. è¯»å–é€‰å®šçš„ BDL ç»„ä»¶æºä»£ç 
4. æ„å»ºè¯¦ç»†çš„è½¬æ¢è¦æ±‚ prompt
5. è°ƒç”¨ä»£ç ç”Ÿæˆ Agent
6. éªŒè¯ç”Ÿæˆçš„ä»£ç ï¼ˆåŸºæœ¬è¯­æ³•æ£€æŸ¥ï¼‰
7. ä¿å­˜ä»£ç åˆ°æ–‡ä»¶

**è¾“å…¥**:
- `file_analyses`: å½“å‰ç»„ä»¶åˆ†æç»“æœ
- `dependency_analyses`: ä¾èµ–ç»„ä»¶åˆ†æç»“æœ
- `selected_bdl_components`: é€‰å®šçš„ BDL ç»„ä»¶
- `resource_type`: ç»„ä»¶ resourceType

**è¾“å‡º**:
- `generated_code`: ç”Ÿæˆçš„ React ä»£ç 
- `code_file_path`: ä»£ç æ–‡ä»¶è·¯å¾„

**è½¬æ¢è§„åˆ™**:
1. **UI ç»“æ„**: HTL â†’ JSXï¼ˆä¿æŒç›¸åŒç»“æ„å’Œå±‚æ¬¡ï¼‰
2. **Props æ¥å£**: Dialog å­—æ®µ â†’ React props
3. **æ•°æ®ç»‘å®š**: data-sly-use â†’ React props/state
4. **æ¡ä»¶æ¸²æŸ“**: data-sly-test â†’ React æ¡ä»¶æ¸²æŸ“
5. **è¿­ä»£**: data-sly-repeat â†’ Array.map()
6. **äº‹ä»¶å¤„ç†**: HTL/JS äº‹ä»¶ â†’ React äº‹ä»¶å¤„ç†å™¨
7. **ç»„ä»¶ç»„åˆ**: data-sly-resource â†’ React ç»„ä»¶å¯¼å…¥
8. **BDL ä½¿ç”¨**: ä½¿ç”¨é€‰å®šçš„ BDL ç»„ä»¶

**å…³é”®ç‰¹æ€§**:
- âœ… è¯¦ç»†çš„è½¬æ¢è¦æ±‚
- âœ… ä¾èµ–ç»„ä»¶å¤„ç†
- âœ… æ–‡ä»¶ä¸Šä¸‹æ–‡è¯´æ˜
- âœ… åŸºæœ¬ä»£ç éªŒè¯
- âœ… æ™ºèƒ½ä»£ç æå–

---

### æ­¥éª¤ 5: å®¡æŸ¥ä»£ç  (`review_code`)

**ç›®çš„**: å¤šç»´åº¦å®¡æŸ¥ç”Ÿæˆçš„ä»£ç è´¨é‡

**å¤„ç†æµç¨‹**:
1. è¿è¡Œä¸‰ä¸ªå®¡æŸ¥å­ Agentï¼š
   - **SecurityReviewAgent**: å®‰å…¨æ£€æŸ¥
   - **BuildReviewAgent**: æ„å»ºå’Œä»£ç è´¨é‡æ£€æŸ¥
   - **BDLReviewAgent**: BDL åˆè§„æ€§æ£€æŸ¥
2. æ±‡æ€»å®¡æŸ¥ç»“æœ
3. åˆ¤æ–­æ˜¯å¦é€šè¿‡

**è¾“å…¥**:
- `generated_code`: ç”Ÿæˆçš„ä»£ç 
- `code_file_path`: ä»£ç æ–‡ä»¶è·¯å¾„
- `iteration_count`: å½“å‰è¿­ä»£æ¬¡æ•°

**è¾“å‡º**:
- `review_results`: å®¡æŸ¥ç»“æœï¼ˆsecurity, build, bdlï¼‰
- `review_passed`: æ˜¯å¦é€šè¿‡ï¼ˆboolï¼‰

**å®¡æŸ¥ç»´åº¦**:

#### Security Review
- XSS æ¼æ´
- æ³¨å…¥æ”»å‡»
- ä¸å®‰å…¨çš„ API ä½¿ç”¨
- æ•æ„Ÿæ•°æ®æš´éœ²
- ä¸å®‰å…¨çš„ä¾èµ–

#### Build Review
- ç¼–è¯‘é”™è¯¯
- è¯­æ³•é—®é¢˜
- ç¼ºå¤±ä¾èµ–
- ä»£ç è´¨é‡
- ç±»å‹é”™è¯¯

#### BDL Review
- BDL ç»„ä»¶ä½¿ç”¨æ­£ç¡®æ€§
- BDL æ ·å¼æ–¹æ³•
- BDL ç»„ä»¶ç»„åˆ
- BDL çº¦å®šéµå¾ª

**å…³é”®ç‰¹æ€§**:
- âœ… ç»“æ„åŒ–è¾“å‡ºï¼ˆPydantic æ¨¡å‹ï¼‰
- âœ… è¿­ä»£ä¸Šä¸‹æ–‡ï¼ˆçŸ¥é“æ˜¯ç¬¬å‡ æ¬¡å®¡æŸ¥ï¼‰
- âœ… è¯¦ç»†çš„é—®é¢˜å’Œå»ºè®®
- âœ… ä¸¥é‡æ€§åˆ†çº§

---

### æ­¥éª¤ 6: ä¿®æ­£ä»£ç  (`correct_code`)

**ç›®çš„**: æ ¹æ®å®¡æŸ¥ç»“æœä¿®æ­£ä»£ç 

**å¤„ç†æµç¨‹**:
1. æ„å»ºè¯¦ç»†çš„å®¡æŸ¥ç»“æœæ‘˜è¦
2. æŒ‰ä¼˜å…ˆçº§ç»„ç»‡é—®é¢˜ï¼ˆCritical > High > Medium > Lowï¼‰
3. è°ƒç”¨ä¿®æ­£ Agent
4. æå–ä¿®æ­£åçš„ä»£ç 
5. ç«‹å³å†™å…¥æ–‡ä»¶
6. å¢åŠ è¿­ä»£è®¡æ•°

**è¾“å…¥**:
- `generated_code`: å½“å‰ä»£ç 
- `review_results`: å®¡æŸ¥ç»“æœ
- `iteration_count`: å½“å‰è¿­ä»£æ¬¡æ•°

**è¾“å‡º**:
- `generated_code`: ä¿®æ­£åçš„ä»£ç 
- `iteration_count`: è¿­ä»£æ¬¡æ•° + 1

**ä¿®æ­£ä¼˜å…ˆçº§**:
1. **CRITICAL**: æ„å»ºé”™è¯¯ã€å…³é”®å®‰å…¨æ¼æ´
2. **HIGH**: å®‰å…¨æ¼æ´ã€æ„å»ºè­¦å‘Šã€BDL åˆè§„é—®é¢˜
3. **MEDIUM**: ä»£ç è´¨é‡æ”¹è¿›ã€BDL æœ€ä½³å®è·µ
4. **LOW**: æ€§èƒ½ä¼˜åŒ–

**å…³é”®ç‰¹æ€§**:
- âœ… å®Œæ•´çš„å®¡æŸ¥ç»“æœä¸Šä¸‹æ–‡
- âœ… ä¼˜å…ˆçº§æ’åº
- âœ… æ™ºèƒ½ä»£ç æå–
- âœ… ç«‹å³å†™å…¥æ–‡ä»¶ï¼ˆç¡®ä¿ review èƒ½è¯»å–æœ€æ–°ç‰ˆæœ¬ï¼‰

---

### æ¡ä»¶åˆ¤æ–­: æ˜¯å¦ç»§ç»­ (`should_continue`)

**ç›®çš„**: å†³å®šæ˜¯å¦ç»§ç»­ä¿®æ­£å¾ªç¯

**åˆ¤æ–­é€»è¾‘**:
```python
if review_passed:
    return "end"  # æ‰€æœ‰å®¡æŸ¥é€šè¿‡ï¼Œç»“æŸ
elif iteration_count >= max_iterations:
    return "end"  # è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œç»“æŸ
else:
    return "correct"  # ç»§ç»­ä¿®æ­£
```

**å‚æ•°**:
- `review_passed`: æ˜¯å¦é€šè¿‡å®¡æŸ¥
- `iteration_count`: å½“å‰è¿­ä»£æ¬¡æ•°
- `max_iterations`: æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼ˆé»˜è®¤ 5ï¼‰

---

## ğŸ”„ çŠ¶æ€ç®¡ç†

### WorkflowState ç»“æ„

```python
class WorkflowState(TypedDict):
    # è¾“å…¥é…ç½®
    resource_type: str              # AEM component resourceType
    aem_repo_path: str              # AEM repository æ ¹è·¯å¾„
    component_path: str             # å®Œæ•´ç»„ä»¶è·¯å¾„
    bdl_library_path: str           # BDL library æ ¹è·¯å¾„
    output_path: str                # è¾“å‡ºè·¯å¾„
    
    # æ–‡ä»¶æ”¶é›†
    files: List[str]                # æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨
    dependency_tree: Dict[str, Any] # ä¾èµ–æ ‘
    
    # åˆ†æç»“æœ
    file_analyses: List[Dict]       # å½“å‰ç»„ä»¶åˆ†æ
    dependency_analyses: Dict        # ä¾èµ–ç»„ä»¶åˆ†æ
    
    # ç»„ä»¶é€‰æ‹©
    selected_bdl_components: List[str]  # é€‰å®šçš„ BDL ç»„ä»¶
    aem_component_summary: Dict         # AEM ç»„ä»¶æ‘˜è¦
    
    # ä»£ç ç”Ÿæˆ
    generated_code: str              # ç”Ÿæˆçš„ä»£ç 
    code_file_path: str             # ä»£ç æ–‡ä»¶è·¯å¾„
    
    # å®¡æŸ¥å’Œä¿®æ­£
    review_results: Dict            # å®¡æŸ¥ç»“æœ
    review_passed: bool             # æ˜¯å¦é€šè¿‡
    iteration_count: int             # è¿­ä»£æ¬¡æ•°
    max_iterations: int             # æœ€å¤§è¿­ä»£æ¬¡æ•°
    
    # æ¶ˆæ¯
    messages: List                  # LangGraph æ¶ˆæ¯
```

---

## ğŸ¯ å…³é”®ç‰¹æ€§æ€»ç»“

### 1. é€’å½’ä¾èµ–å¤„ç† âœ…
- è‡ªåŠ¨å‘ç°æ‰€æœ‰ä¾èµ–ç»„ä»¶
- é€’å½’åˆ†æä¾èµ–ç»„ä»¶
- å¾ªç¯ä¾èµ–æ£€æµ‹
- æ·±åº¦é™åˆ¶ä¿æŠ¤

### 2. æ™ºèƒ½ç»„ä»¶åŒ¹é… âœ…
- AEM åŠŸèƒ½åˆ†æ
- BDL ç»„ä»¶æœç´¢
- ç›¸å…³æ€§éªŒè¯
- é‡æ–°æœç´¢æœºåˆ¶

### 3. å¤šç»´åº¦å®¡æŸ¥ âœ…
- å®‰å…¨æ£€æŸ¥
- æ„å»ºæ£€æŸ¥
- BDL åˆè§„æ£€æŸ¥
- ç»“æ„åŒ–è¾“å‡º

### 4. è¿­ä»£ä¼˜åŒ– âœ…
- è‡ªåŠ¨ä¿®æ­£å¾ªç¯
- ä¼˜å…ˆçº§æ’åº
- æœ€å¤§è¿­ä»£é™åˆ¶
- è¯¦ç»†åé¦ˆ

### 5. ç»“æ„åŒ–è¾“å‡º âœ…
- Pydantic æ¨¡å‹
- ç±»å‹å®‰å…¨
- æ˜“äºè§£æ
- é”™è¯¯å¤„ç†

---

## ğŸ“Š æ•°æ®æµå›¾

```
è¾“å…¥ (resourceType, paths)
    â”‚
    â–¼
[æ–‡ä»¶æ”¶é›†] â”€â”€â†’ files[], dependency_tree
    â”‚
    â–¼
[æ–‡ä»¶åˆ†æ] â”€â”€â†’ file_analyses[], dependency_analyses{}
    â”‚
    â–¼
[BDLé€‰æ‹©] â”€â”€â†’ selected_bdl_components[]
    â”‚
    â–¼
[ä»£ç ç”Ÿæˆ] â”€â”€â†’ generated_code, code_file_path
    â”‚
    â–¼
[ä»£ç å®¡æŸ¥] â”€â”€â†’ review_results{}, review_passed
    â”‚
    â”œâ”€ é€šè¿‡ â”€â”€â†’ [ç»“æŸ]
    â”‚
    â””â”€ æœªé€šè¿‡ â”€â”€â†’ [ä»£ç ä¿®æ­£] â”€â”€â†’ [å†æ¬¡å®¡æŸ¥] â”€â”€â†’ ...
```

---

## ğŸ”§ Agent æ¶æ„

### æ ¸å¿ƒ Agents

1. **AEMAnalysisAgent**
   - åˆ†æ AEM æ–‡ä»¶
   - æå–å…³é”®ä¿¡æ¯
   - ç»“æ„åŒ–è¾“å‡º

2. **BDLSelectionAgent**
   - æœç´¢ BDL ç»„ä»¶
   - éªŒè¯åŒ¹é…åº¦
   - é€‰æ‹©æœ€ä½³ç»„ä»¶

3. **CodeWritingAgent**
   - ç”Ÿæˆ React ä»£ç 
   - éµå¾ªè½¬æ¢è§„åˆ™
   - ä½¿ç”¨ BDL ç»„ä»¶

4. **SecurityReviewAgent**
   - å®‰å…¨æ£€æŸ¥
   - æ¼æ´è¯†åˆ«
   - ä¿®å¤å»ºè®®

5. **BuildReviewAgent**
   - æ„å»ºæ£€æŸ¥
   - ä»£ç è´¨é‡
   - é”™è¯¯è¯†åˆ«

6. **BDLReviewAgent**
   - BDL åˆè§„æ£€æŸ¥
   - ç»„ä»¶ä½¿ç”¨éªŒè¯
   - æœ€ä½³å®è·µæ£€æŸ¥

7. **CorrectAgent**
   - ä»£ç ä¿®æ­£
   - é—®é¢˜ä¿®å¤
   - ä¿æŒåŠŸèƒ½

---

## ğŸš€ ä½¿ç”¨æµç¨‹

1. **é…ç½®ç¯å¢ƒå˜é‡** (`.env`)
   ```
   OPENAI_API_KEY=your_key
   AEM_REPO_PATH=/path/to/aem/repo
   BDL_LIBRARY_PATH=/path/to/bdl/library
   ```

2. **è¿è¡Œç¨‹åº**
   ```bash
   python main.py
   ```

3. **è¾“å…¥ resourceType**
   ```
   Enter AEM component resourceType: example/components/button
   ```

4. **ç­‰å¾…å¤„ç†**
   - æ–‡ä»¶æ”¶é›†
   - ä¾èµ–è§£æ
   - æ–‡ä»¶åˆ†æ
   - ç»„ä»¶é€‰æ‹©
   - ä»£ç ç”Ÿæˆ
   - ä»£ç å®¡æŸ¥
   - ä»£ç ä¿®æ­£ï¼ˆå¦‚æœéœ€è¦ï¼‰

5. **è·å–ç»“æœ**
   - ç”Ÿæˆçš„ React ç»„ä»¶æ–‡ä»¶
   - å®¡æŸ¥æŠ¥å‘Š
   - è¿­ä»£å†å²

---

## ğŸ“ˆ æ€§èƒ½è€ƒè™‘

- **ä¾èµ–æ·±åº¦é™åˆ¶**: æœ€å¤§ 5 å±‚ï¼Œé˜²æ­¢è¿‡æ·±ä¾èµ–
- **æ–‡ä»¶åˆ†æé™åˆ¶**: æ¯ä¸ªä¾èµ–ç»„ä»¶æœ€å¤š 10 ä¸ªæ–‡ä»¶
- **è¿­ä»£æ¬¡æ•°é™åˆ¶**: é»˜è®¤ 5 æ¬¡ï¼Œé˜²æ­¢æ— é™å¾ªç¯
- **é‡è¯•æœºåˆ¶**: ç½‘ç»œé”™è¯¯è‡ªåŠ¨é‡è¯•ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
- **ç¼“å­˜**: å¯é€‰çš„ä¾èµ–åˆ†æç¼“å­˜

---

## âœ… æ€»ç»“

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€è‡ªåŠ¨åŒ–çš„ AEM åˆ° React ç»„ä»¶è½¬æ¢ç³»ç»Ÿï¼Œå…·æœ‰ï¼š

- âœ… **é€’å½’ä¾èµ–å¤„ç†** - è‡ªåŠ¨å‘ç°å’Œåˆ†ææ‰€æœ‰ä¾èµ–
- âœ… **æ™ºèƒ½ç»„ä»¶åŒ¹é…** - è‡ªåŠ¨é€‰æ‹©æœ€åˆé€‚çš„ BDL ç»„ä»¶
- âœ… **å¤šç»´åº¦å®¡æŸ¥** - ç¡®ä¿ä»£ç è´¨é‡å’Œå®‰å…¨æ€§
- âœ… **è¿­ä»£ä¼˜åŒ–** - è‡ªåŠ¨ä¿®æ­£ç›´åˆ°é€šè¿‡å®¡æŸ¥
- âœ… **ç»“æ„åŒ–è¾“å‡º** - ç±»å‹å®‰å…¨ã€æ˜“äºå¤„ç†

æ•´ä¸ªæµç¨‹è®¾è®¡åˆç†ï¼Œèƒ½å¤Ÿå¤„ç†å¤æ‚çš„ AEM ç»„ä»¶è½¬æ¢åœºæ™¯ï¼ğŸ‰
